{"ts":1372550501695,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var http    = require('http');\nvar server  = http.createServer();\nvar url     = require('url');\nvar parse   = url.parse;\nvar join    = require('path').join;\nvar fs      = require('fs');\nvar root    = __dirname;\nvar items   = [];\nvar qs      = require('querystring');\n\n// Cloud9: use 'process.env.PORT' as the port and 'process.env.IP' as the host in your scripts\nprocess.env.PORT = process.env.PORT? process.env.PORT : \"3000\";\nprocess.env.IP   = process.env.IP? process.env.IP : \"127.0.0.1\";\n\nfunction show(response){\n    var html = '<html><head><title>Todo List</title></head><body>';\n    html += '<h1>Todo List</h1></ul>';\n    html += items.map(function(item){\n        return '<li>' + item + '</li>';\n    }).join('');\n    html += '</ul>';\n    html += '<form method=\"post\" action=\"/\">';\n    html += '<p><input type=\"text\" name=\"item\" /></p>';\n    html += '<p><input type=\"submit\" value=\"Add Item\" /></p>';\n    html += '</form></body></html>';\n    response.setHeader('Content-Type', 'text/html');\n    response.setHeader('Content-Length', Buffer.byteLength(html));\n    response.end(html);\n}\n\nfunction notFound(response) {\n    response.statusCode = 404;\n    response.setHeader('Content-Type', 'text/plain');\n    response.end('Not Found');\n}\nfunction badRequest(response) {\n    response.statusCode = 400;\n    response.setHeader('Content-Type', 'text/plain');\n    response.end('Bad Request');\n}\nfunction add(request, response) {\n    var body = '';\n    request.setEncoding('utf8');\n    request.on('data', function(chunk){\n        body += chunk;\n    });\n    request.on('end', function(){\n        var obj = qs.parse(body);\n        items.push(obj.item);\n        show(response);\n    });\n}\nserver.on('request', function(request, response){\n    if ('/' === request.url) {\n        switch (request.method) {\n            case 'GET':\n                show(response);\n                break;\n            case 'POST':\n                add(request, response);\n                break;\n            default:\n                badRequest(response);\n        }\n    } else {\n        notFound(response);\n    }\n\n});\nserver.listen(process.env.PORT, function() {\n    console.log('Server running at http://' + process.env.IP + \":\" + process.env.PORT + \"/\");\n});"]],"start1":0,"start2":0,"length1":0,"length2":2225}]],"length":2225}
{"contributors":[],"silentsave":false,"ts":1372550790105,"patch":[[{"diffs":[[0,"  });\n}\n"],[1,"function upload(request, response) {\n    \n}\n"],[0,"server.o"]],"start1":1672,"start2":1672,"length1":16,"length2":60},{"diffs":[[0,"        "],[1,"uplo"],[0,"a"],[-1,"d"],[0,"d(reques"]],"start1":1951,"start2":1951,"length1":18,"length2":21}]],"length":2272,"saved":false}
{"ts":1372550932649,"patch":[[{"diffs":[[0,"><title>"],[-1,"Todo List"],[1,"Formidable"],[0,"</title>"]],"start1":545,"start2":545,"length1":25,"length2":26},{"diffs":[[0,"= '<"],[-1,"h1>Todo List</h1></ul>';\n    html += items.map(function(item){\n        return '<li>' + item + '</li>';\n    }).join('');\n    html += '</ul>';\n    html += '<form method=\"post\" action=\"/\""],[1,"form method=\"POST\" action=\"/\" enctype=\"multipart/form-data\">';\n    html += '<p><input type=\"text\" name=\"name\" /></p"],[0,">';\n"]],"start1":597,"start2":597,"length1":192,"length2":123},{"diffs":[[0,"pe=\""],[-1,"text"],[1,"file"],[0,"\" name=\""],[-1,"item"],[1,"file"],[0,"\" />"]],"start1":745,"start2":745,"length1":24,"length2":24},{"diffs":[[0,"ue=\""],[-1,"Add Item"],[1,"Upload"],[0,"\" />"],[1," "],[0,"</p>"]],"start1":816,"start2":816,"length1":20,"length2":19},{"diffs":[[0,"orm>"],[-1,"</body></html>"],[0,"';\n "]],"start1":854,"start2":854,"length1":22,"length2":8}]],"length":2189,"saved":false}
{"ts":1372551105513,"patch":[[{"diffs":[[0,"tring');"],[1,"\nvar formidable = require('formidable');"],[0,"\n\n// Clo"]],"start1":258,"start2":258,"length1":16,"length2":56},{"diffs":[[0,") {\n    "],[1,"if(!isFormData(request)) {\n        response.statusCode = 400;\n        response.end('Bad Request: expecting multipart/form-data');\n        return;\n    }\n}\nfunction isFormData(request){\n    var type = request.headers['content-type'] || '';\n    return 0 === type.indexOf('multipart/form-data');"],[0,"\n}\nserve"]],"start1":1670,"start2":1670,"length1":16,"length2":307}]],"length":2520,"saved":false}
{"ts":1372551141761,"patch":[[{"diffs":[[0,";\n    }\n"],[1,"    var form = new formidable.IncomingForm()\n    form.parse(request);\n"],[0,"}\nfuncti"]],"start1":1822,"start2":1822,"length1":16,"length2":86}]],"length":2590,"saved":false}
{"ts":1372551249641,"patch":[[{"diffs":[[0,"ngForm()"],[1,";\n    form.on('field', function(field, value) {\n        console.log(field + \"] [\" + value + \"]\");\n    })\n    form.on('file', function(name, file) {\n        console.log(\"[\" + name +\"] [\"+ file + \"]\");\n    })"],[0,"\n    for"]],"start1":1866,"start2":1866,"length1":16,"length2":222}]],"length":2796,"saved":false}
{"ts":1372551270936,"patch":[[{"diffs":[[0,"e + \"]\");\n    })"],[1,";"],[0,"\n    form.on('fi"]],"start1":1962,"start2":1962,"length1":32,"length2":33},{"diffs":[[0,"ile + \"]\");\n"],[1,"    });\n    form.on('end', function(){\n        response.end('upload complete');\n"],[0,"    })\n    f"]],"start1":2063,"start2":2063,"length1":24,"length2":104}]],"length":2877,"saved":false}
{"ts":1372551274760,"patch":[[{"diffs":[[0,";\n    })"],[1,";"],[0,"\n    for"]],"start1":2153,"start2":2153,"length1":16,"length2":17}]],"length":2878,"saved":false}
{"ts":1372551456339,"patch":[[{"diffs":[[0,"ole.log("],[1,"\"Input field name is: [\" + "],[0,"field + "]],"start1":1934,"start2":1934,"length1":16,"length2":43}]],"length":2905,"saved":false}
{"ts":1372551463119,"patch":[[{"diffs":[[0,"eld + \"]"],[1,", Value is:"],[0," [\" + va"]],"start1":1971,"start2":1971,"length1":16,"length2":27}]],"length":2916,"saved":false}
{"ts":1372551506576,"patch":[[{"diffs":[[0,"+ file + \"]\""],[1," + file.size + \"] [\" + file.name"],[0,");\n    });\n "]],"start1":2098,"start2":2098,"length1":24,"length2":56}]],"length":2948,"saved":false}
{"ts":1372551560955,"patch":[[{"diffs":[[0,"ile + \"]"],[1," File size is: ["],[0,"\" + file"]],"start1":2101,"start2":2101,"length1":16,"length2":32},{"diffs":[[0,"ize + \"]"],[1," Filename is:"],[0," [\" + fi"]],"start1":2135,"start2":2135,"length1":16,"length2":29},{"diffs":[[0,"ile.name"],[1," + \"]\""],[0,");\n    }"]],"start1":2163,"start2":2163,"length1":16,"length2":22}]],"length":2983,"saved":false}
{"ts":1372551572188,"patch":[[{"diffs":[[0,"e +\"] [\""],[-1,"+ file"],[0," + \"] Fi"]],"start1":2090,"start2":2090,"length1":22,"length2":16}]],"length":2977,"saved":false}
{"ts":1372551592243,"patch":[[{"diffs":[[0,"le.name + \"]\");\n"],[1,"        console.log(file);\n"],[0,"    });\n    form"]],"start1":2158,"start2":2158,"length1":32,"length2":59}]],"length":3004,"saved":false}
{"ts":1372551750436,"patch":[[{"diffs":[[0,"Form();\n"],[1,"    form.parse(request, function(error, fields, files){\n       console.log(fields);\n       console.log(files);\n       response.end('upload complete');\n    });\n    /*\n"],[0,"    form"]],"start1":1868,"start2":1868,"length1":16,"length2":182},{"diffs":[[0,"quest);\n"],[1,"    */\n"],[0,"}\nfuncti"]],"start1":2472,"start2":2472,"length1":16,"length2":23}]],"length":3177,"saved":false}
{"ts":1372551857426,"patch":[[{"diffs":[[0,"Form();\n"],[1,"    form.on('progress'< function(bytesReceived, bytesExpected){\n        var percent = Math.floor(bytesReceived / bytesExpected * 100);\n        console.log(percent);\n    });\n"],[0,"    form"]],"start1":1868,"start2":1868,"length1":16,"length2":189}]],"length":3350,"saved":false}
{"ts":1372551883161,"patch":[[{"diffs":[[0,"rogress'"],[-1,"<"],[1,","],[0," functio"]],"start1":1890,"start2":1890,"length1":17,"length2":17}]],"length":3350,"saved":false}
